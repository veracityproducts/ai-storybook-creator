# High-Level Agents for Decodable Reader Workflow

This document describes the agents used in the pipeline, their responsibilities, inputs/outputs, and recommended prompts.

Agents

1) Style Bible Agent
- Purpose: Produce a concise visual style guide for consistent illustrations
- Inputs: title, theme
- Prompt: prompts/style-bible.md
- Output: short bullet list (string) used by image prompt agent

2) Story Author Agent
- Purpose: Generate a decodable story JSON conforming to phonics scope
- Inputs: title, theme, ageRange, PhonicsConfig (approved/heart/banned words, punctuation, etc.)
- Prompt: prompts/system.md + prompts/story-json.md (schema enforced via code)
- Output: Story JSON (title, pages[], moral)

3) Guardrail Validator Agent (LLM)
- Purpose: Produce human-readable validation and list offending words; code remains source of truth
- Inputs: Story JSON, PhonicsConfig
- Prompt: prompts/guardrail-validate.md
- Output: { valid, issues[], offendingWords[] }

4) Repair Agent
- Purpose: Rewrite the story using only allowed words until valid
- Inputs: Invalid Story JSON, offendingWords, PhonicsConfig
- Prompt: prompts/guardrail-repair.md (schema enforced via code)
- Output: Repaired Story JSON

5) Page Image Prompt Agent
- Purpose: Create a concise, consistent illustration prompt per page
- Inputs: Style Bible, page text
- Prompt: prompts/image-page.md
- Output: one-line prompt per page

6) Alt Text Agent
- Purpose: Generate decodable alt text
- Inputs: page text, PhonicsConfig words
- Prompt: prompts/alt-text.md
- Output: single line alt text

Notes
- The Story Author and Repair agents must be wrapped with deterministic validation (lib/decodability/validate.ts).
- Images may be generated by Gemini or another provider; the Page Image Prompt agent is provider-agnostic.

